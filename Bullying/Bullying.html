<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生對生校園霸凌事件處理流程圖</title>
    <!-- 載入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 載入 React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- 載入 Babel 用於瀏覽器解析 JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { background-color: #f8fafc; }
        .transition-all { transition: all 0.3s ease; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // 手寫 SVG 圖示組件以確保在 CDN 環境下完美運作
        const IconInfo = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>;
        const IconUsers = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M23 7a4 4 0 0 0-3-3.87"/></svg>;
        const IconShield = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/></svg>;
        const IconScale = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h18"/></svg>;
        const IconClock = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>;
        const IconChevronRight = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m9 18 6-6-6-6"/></svg>;
        const IconHelp = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>;

        const App = () => {
            const [activeStep, setActiveStep] = useState(null);
            const [activeRole, setActiveRole] = useState('all');

            const steps = [
                { id: 'receive', title: '1. 接獲檢舉與通報', section: '受理階段', legal: '§17, §18', desc: '校長、職員、教師知悉疑似霸凌事件，需立即啟動。', adminNote: '24 小時內完成校安通報及社政通報。', teacherNote: '知悉後應立即向學校權責人員報告。', parentNote: '可向學校、教育局或部長信箱提出檢舉。', color: 'bg-blue-50', borderColor: 'border-blue-500', icon: <IconInfo /> },
                { id: 'jurisdiction', title: '2. 確認調查權責', section: '受理階段', legal: '§18, §20', desc: '確認案件是否屬於本校管轄權責。', adminNote: '若非本校管轄，3 個工作日內移送調查學校。', color: 'bg-blue-50', borderColor: 'border-blue-500', icon: <IconScale /> },
                { id: 'review', title: '3. 審查小組會議', section: '受理階段', legal: '§24, §25', desc: '決定是否受理案件。受理起 5 日內需組成處理小組。', adminNote: '接獲檢舉起 20 個工作日內需決議是否受理。', parentNote: '若不受理，檢舉人可於 20 日內提出陳情。', color: 'bg-blue-50', borderColor: 'border-blue-500', icon: <IconUsers /> },
                { id: 'handling', title: '4. 組成處理小組', section: '調和/調查階段', legal: '§27, §29', desc: '召開會前會，選擇採行「調和」或「調查」程序。', teacherNote: '教師可能被邀請參與小組，需保持公正立場。', parentNote: '「調和」必須經雙方當事人同意始得進行。', color: 'bg-yellow-50', borderColor: 'border-yellow-500', icon: <IconShield /> },
                { id: 'pathway', title: '5. 調和或調查程序', section: '調和/調查階段', legal: '§29, §30, §32', desc: '執行具體訪談與事實釐清。', adminNote: '調查報告需於 2 個月內完成（可延長 2 次）。', teacherNote: '配合訪談並提供相關觀察輔導記錄。', parentNote: '調和中任一方可隨時終止調和，轉入調查。', color: 'bg-yellow-50', borderColor: 'border-yellow-500', icon: <IconClock /> },
                { id: 'committee', title: '6. 防制委員會審議', section: '審議階段', legal: '§34, §43, §46', desc: '審議報告並作成終局決議。', adminNote: '確認霸凌後，15 個工作日內作成終局處理。', parentNote: '雙方可對報告內容提出陳述意見。', color: 'bg-purple-50', borderColor: 'border-purple-500', icon: <IconScale /> },
                { id: 'remedy', title: '7. 結果通知與救濟', section: '救濟程序', legal: '§46, §48, §49', desc: '書面通知處理結果與救濟管道。', adminNote: '10 個工作日內報主管機關備查。', parentNote: '若不服決議，可依規定啟動申訴或救濟程序。', color: 'bg-green-50', borderColor: 'border-green-500', icon: <IconChevronRight /> }
            ];

            const filteredNote = (step) => {
                if (activeRole === 'parent') return step.parentNote;
                if (activeRole === 'teacher') return step.teacherNote;
                if (activeRole === 'admin') return step.adminNote;
                return step.desc;
            };

            const isHighlighted = (step) => {
                if (activeRole === 'parent' && step.parentNote) return true;
                if (activeRole === 'teacher' && step.teacherNote) return true;
                if (activeRole === 'admin' && step.adminNote) return true;
                if (activeRole === 'all') return true;
                return false;
            };

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <div className="max-w-5xl mx-auto">
                        <div className="mb-8 text-center">
                            <h1 className="text-3xl font-bold text-slate-800 mb-2">生對生校園霸凌事件處理流程圖</h1>
                            <p className="text-slate-500">依據《校園霸凌防制準則》最新修訂製作</p>
                            <div className="flex flex-wrap justify-center gap-2 mt-6">
                                {[
                                    { id: 'all', label: '全部顯示', icon: <IconHelp /> },
                                    { id: 'parent', label: '家長需知', icon: <IconUsers /> },
                                    { id: 'teacher', label: '教師重點', icon: <IconInfo /> },
                                    { id: 'admin', label: '行政/校方', icon: <IconShield /> }
                                ].map(role => (
                                    <button key={role.id} onClick={() => setActiveRole(role.id)}
                                        className={`flex items-center gap-2 px-4 py-2 rounded-full border transition-all ${activeRole === role.id ? 'bg-blue-600 text-white border-blue-600 shadow-md' : 'bg-white text-slate-600 border-slate-200 hover:border-blue-300'}`}>
                                        {role.icon} {role.label}
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div className="lg:col-span-2 space-y-4">
                                {steps.map((step, index) => (
                                    <div key={step.id} className="relative">
                                        {index !== steps.length - 1 && <div className="absolute left-6 top-12 w-0.5 h-12 bg-slate-200 z-0"></div>}
                                        <div onClick={() => setActiveStep(step)}
                                            className={`relative z-10 flex items-start gap-4 p-4 rounded-xl border-2 cursor-pointer transition-all ${activeStep?.id === step.id ? 'shadow-lg scale-[1.02]' : 'hover:shadow-md'} ${isHighlighted(step) ? `${step.borderColor} ${step.color}` : 'border-slate-100 bg-white opacity-60'}`}>
                                            <div className={`mt-1 p-2 rounded-lg bg-white shadow-sm border ${step.borderColor}`}>{step.icon}</div>
                                            <div className="flex-1">
                                                <div className="flex justify-between items-start">
                                                    <span className="text-xs font-bold text-slate-400 uppercase tracking-wider">{step.section}</span>
                                                    <span className="text-xs font-mono bg-slate-200 px-2 py-1 rounded text-slate-600">{step.legal}</span>
                                                </div>
                                                <h3 className="text-lg font-bold mt-1">{step.title}</h3>
                                                <p className="text-sm text-slate-600 mt-2">{filteredNote(step) || step.desc}</p>
                                            </div>
                                            <IconChevronRight className={`mt-8 transition-transform ${activeStep?.id === step.id ? 'rotate-90' : ''}`} />
                                        </div>
                                    </div>
                                ))}
                            </div>

                            <div className="lg:col-span-1">
                                <div className="sticky top-8 bg-white rounded-2xl border border-slate-200 shadow-xl overflow-hidden">
                                    <div className="bg-slate-800 p-4 text-white"><h2 className="text-xl font-bold">詳細說明區</h2></div>
                                    <div className="p-6 space-y-6">
                                        {activeStep ? (
                                            <>
                                                <div>
                                                    <h3 className="text-blue-600 font-bold mb-2">階段概述</h3>
                                                    <p className="text-slate-700 text-sm leading-relaxed">{activeStep.desc}</p>
                                                </div>
                                                <div className="space-y-4">
                                                    {activeStep.adminNote && <div className="p-3 rounded bg-slate-50 border-l-4 border-slate-700"><div className="font-bold text-xs">行政任務</div><p className="text-xs">{activeStep.adminNote}</p></div>}
                                                    {activeStep.teacherNote && <div className="p-3 rounded bg-blue-50 border-l-4 border-blue-500"><div className="font-bold text-xs text-blue-700">教師重點</div><p className="text-xs">{activeStep.teacherNote}</p></div>}
                                                    {activeStep.parentNote && <div className="p-3 rounded bg-orange-50 border-l-4 border-orange-500"><div className="font-bold text-xs text-orange-700">家長權益</div><p className="text-xs">{activeStep.parentNote}</p></div>}
                                                </div>
                                            </>
                                        ) : (
                                            <div className="py-12 text-slate-400 text-center text-sm"><p>請點擊左側流程節點<br/>查看詳細資訊</p></div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
